### Техническое задание: Микросервисная архитектура на Go (3 микросервиса)

---

#### **1. Общее описание**
Цель: Создание масштабируемой микросервисной системы для управления пользователями, заказами и уведомлениями.  
**Стек**:  
- Язык: Go (Golang)  
- Дополнительные технологии: Kafka (опционально), gRPC (опционально), REST API.  
- Базы данных: PostgreSQL, MongoDB.  
- Инфраструктура: Docker, Docker Compose, API Gateway (Gin).  

---

#### **2. Архитектура**
Система состоит из трёх микросервисов:  
1. **User Service**  
2. **Order Service**  
3. **Notification Service**  

**Коммуникация**:  
- REST API — для внешних запросов.  
- gRPC (опционально) — для высокопроизводительного взаимодействия между сервисами.  
- Kafka (опционально) — для асинхронной обработки событий (например, уведомлений).  

---

#### **3. Описание микросервисов**
##### **3.1. User Service**  
**Функционал**:  
- Регистрация, аутентификация (JWT), управление профилем.  
- Роли пользователей (user/admin).  

**Технологии**:  
- REST API (Gin или Echo).  
- PostgreSQL (хранение данных пользователей).  
- gRPC (опционально — для запросов от Order Service).  

**Эндпоинты (REST)**:  
- `POST /register` — регистрация.  
- `POST /login` — аутентификация.  
- `GET /users/{id}` — получение данных пользователя.  

---

##### **3.2. Order Service**  
**Функционал**:  
- Создание, обновление, отмена заказов.  
- Изменение статуса заказа (в процессе, выполнен, отменен).  

**Технологии**:  
- REST/gRPC API.  
- MongoDB (гибкая схема заказов).  
- Интеграция с Kafka (опционально — отправка событий о статусе заказа).  

**События в Kafka (опционально)**:  
- `order_created`  
- `order_updated`  

**Эндпоинты**:  
- `POST /orders` — создание заказа.  
- `PUT /orders/{id}` — обновление заказа.  

---

##### **3.3. Notification Service**  
**Функционал**:  
- Отправка email/SMS-уведомлений.  
- Обработка событий из Kafka (например, уведомление о создании заказа).  

**Технологии**:  
- Kafka Consumer (опционально — подписка на топики `order_created`, `user_registered`).  
- SMTP (SendGrid/Mailgun) или SMS-шлюз (Twilio).  

---

#### **4. Инфраструктура**  
- **Контейнеризация**:  
  - Каждый сервис в отдельном Docker-контейнере.  
  - Docker Compose для развертывания:  
    ```yaml
    services:
      user-service:
        image: user-service:latest
        ports:
          - "8080:8080"
      order-service:
        image: order-service:latest
      notification-service:
        image: notification-service:latest
      postgres:
        image: postgres:14
      mongodb:
        image: mongo:6
      kafka:
        image: bitnami/kafka:3.4 (опционально)
    ```  
- **API Gateway**:  
  - Маршрутизация запросов (например, Gin).  
  - Аутентификация (проверка JWT).  

---

#### **5. Безопасность**  
- HTTPS (TLS) для внешних API.  
- Валидация входных данных.  
- Хеширование паролей (bcrypt).  
- CORS-политики.  

---

#### **6. Логирование и мониторинг**  
- Централизованное логирование (ELK Stack или Loki).  
- Метрики (Prometheus + Grafana).  
- Трейсинг (Jaeger — опционально).  

---

#### **7. Тестирование**  
- Юнит-тесты (стандартная библиотека Go).  
- Интеграционные тесты (с Docker-контейнерами).  
- Тестирование взаимодействия через gRPC/Kafka.  

---

#### **8. Опциональные компоненты**  
- **Kafka**: Для асинхронной и надежной доставки событий.  
- **gRPC**: Для оптимизации взаимодействия между User Service и Order Service.  

---

#### **9. Этапы разработки**  
1. Реализация User Service (REST + PostgreSQL).  
2. Разработка Order Service (REST/gRPC + MongoDB).  
3. Интеграция Kafka для событий (опционально).  
4. Реализация Notification Service.  
5. Настройка API Gateway и инфраструктуры.  

---

#### **10. Возможности расширения**  
- Добавление сервиса аналитики.  
- Поддержка WebSocket для реального времени.  
- Интеграция с платежными системами.  

---

**Итог**: Готовая система с тремя микросервисами, поддерживающая базовые операции, асинхронную коммуникацию (Kafka) и высокопроизводительное взаимодействие (gRPC).